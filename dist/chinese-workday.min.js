!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).chineseWorkday={})}(this,function(t){"use strict";const e=new class{constructor(t=1e3){this.cache=new Map,this.maxSize=t,this.hits=0,this.misses=0}get(t){const e=this.cache.get(t);if(void 0!==e)return this.hits++,this.cache.delete(t),this.cache.set(t,e),e;this.misses++}set(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.maxSize){const t=this.cache.keys().next().value;this.cache.delete(t)}}getStats(){return{size:this.cache.size,maxSize:this.maxSize,hits:this.hits,misses:this.misses,hitRate:this.hits/(this.hits+this.misses)*100}}}(1e3);var n={"2011-01-01":"元旦","2011-01-02":"元旦","2011-01-03":"元旦","2011-02-02":"春节","2011-02-03":"春节","2011-02-04":"春节","2011-02-05":"春节","2011-02-06":"春节","2011-02-07":"春节","2011-02-08":"春节","2011-04-03":"清明节","2011-04-04":"清明节","2011-04-05":"清明节","2011-04-30":"劳动节","2011-05-01":"劳动节","2011-05-02":"劳动节","2011-06-04":"端午节","2011-06-05":"端午节","2011-06-06":"端午节","2011-09-10":"中秋节","2011-09-11":"中秋节","2011-09-12":"中秋节","2011-10-01":"国庆节","2011-10-02":"国庆节","2011-10-03":"国庆节","2011-10-04":"国庆节","2011-10-05":"国庆节","2011-10-06":"国庆节","2011-10-07":"国庆节","2012-01-01":"元旦","2012-01-02":"元旦","2012-01-03":"元旦","2012-01-22":"春节","2012-01-23":"春节","2012-01-24":"春节","2012-01-25":"春节","2012-01-26":"春节","2012-01-27":"春节","2012-01-28":"春节","2012-04-02":"清明节","2012-04-03":"清明节","2012-04-04":"清明节","2012-04-29":"劳动节","2012-04-30":"劳动节","2012-05-01":"劳动节","2012-06-22":"端午节","2012-06-23":"端午节","2012-06-24":"端午节","2012-09-30":"中秋节","2012-10-01":"国庆节","2012-10-02":"国庆节","2012-10-03":"国庆节","2012-10-04":"国庆节","2012-10-05":"国庆节","2012-10-06":"国庆节","2012-10-07":"国庆节","2012-10-08":"国庆节","2013-01-01":"元旦","2013-01-02":"元旦","2013-01-03":"元旦","2013-02-09":"春节","2013-02-10":"春节","2013-02-11":"春节","2013-02-12":"春节","2013-02-13":"春节","2013-02-14":"春节","2013-02-15":"春节","2013-04-04":"清明节","2013-04-05":"清明节","2013-04-06":"清明节","2013-04-29":"劳动节","2013-04-30":"劳动节","2013-05-01":"劳动节","2013-06-10":"端午节","2013-06-11":"端午节","2013-06-12":"端午节","2013-09-19":"中秋节","2013-09-20":"中秋节","2013-09-21":"中秋节","2013-10-01":"国庆节","2013-10-02":"国庆节","2013-10-03":"国庆节","2013-10-04":"国庆节","2013-10-05":"国庆节","2013-10-06":"国庆节","2013-10-07":"国庆节","2014-01-01":"元旦","2014-01-31":"春节","2014-02-01":"春节","2014-02-02":"春节","2014-02-03":"春节","2014-02-04":"春节","2014-02-05":"春节","2014-02-06":"春节","2014-04-05":"清明节","2014-04-06":"清明节","2014-04-07":"清明节","2014-05-01":"劳动节","2014-05-02":"劳动节","2014-05-03":"劳动节","2014-06-02":"端午节","2014-06-03":"端午节","2014-06-04":"端午节","2014-09-08":"中秋节","2014-09-09":"中秋节","2014-09-10":"中秋节","2014-10-01":"国庆节","2014-10-02":"国庆节","2014-10-03":"国庆节","2014-10-04":"国庆节","2014-10-05":"国庆节","2014-10-06":"国庆节","2014-10-07":"国庆节","2015-01-01":"元旦","2015-01-02":"元旦","2015-01-03":"元旦","2015-02-18":"春节","2015-02-19":"春节","2015-02-20":"春节","2015-02-21":"春节","2015-02-22":"春节","2015-02-23":"春节","2015-02-24":"春节","2015-04-04":"清明节","2015-04-05":"清明节","2015-04-06":"清明节","2015-05-01":"劳动节","2015-05-02":"劳动节","2015-05-03":"劳动节","2015-06-20":"端午节","2015-06-21":"端午节","2015-06-22":"端午节","2015-09-26":"中秋节","2015-09-27":"中秋节","2015-10-01":"国庆节","2015-10-02":"国庆节","2015-10-03":"国庆节","2015-10-04":"国庆节","2015-10-05":"国庆节","2015-10-06":"国庆节","2015-10-07":"国庆节","2016-01-01":"元旦","2016-01-02":"元旦","2016-01-03":"元旦","2016-02-07":"春节","2016-02-08":"春节","2016-02-09":"春节","2016-02-10":"春节","2016-02-11":"春节","2016-02-12":"春节","2016-02-13":"春节","2016-04-02":"清明节","2016-04-03":"清明节","2016-04-04":"清明节","2016-04-30":"劳动节","2016-05-01":"劳动节","2016-05-02":"劳动节","2016-06-09":"端午节","2016-06-10":"端午节","2016-06-11":"端午节","2016-09-15":"中秋节","2016-09-16":"中秋节","2016-09-17":"中秋节","2016-10-01":"国庆节","2016-10-02":"国庆节","2016-10-03":"国庆节","2016-10-04":"国庆节","2016-10-05":"国庆节","2016-10-06":"国庆节","2016-10-07":"国庆节","2017-01-01":"元旦","2017-01-02":"元旦","2017-01-27":"春节","2017-01-28":"春节","2017-01-29":"春节","2017-01-30":"春节","2017-01-31":"春节","2017-02-01":"春节","2017-02-02":"春节","2017-04-02":"清明节","2017-04-03":"清明节","2017-04-04":"清明节","2017-04-29":"劳动节","2017-04-30":"劳动节","2017-05-01":"劳动节","2017-05-28":"端午节","2017-05-29":"端午节","2017-05-30":"端午节","2017-10-01":"国庆节","2017-10-02":"国庆节","2017-10-03":"国庆节","2017-10-04":"国庆节","2017-10-05":"国庆节","2017-10-06":"国庆节","2017-10-07":"国庆节","2017-10-08":"国庆节","2018-02-15":"春节","2018-02-16":"春节","2018-02-17":"春节","2018-02-18":"春节","2018-02-19":"春节","2018-02-20":"春节","2018-02-21":"春节","2018-04-05":"清明节","2018-04-06":"清明节","2018-04-07":"清明节","2018-04-29":"劳动节","2018-04-30":"劳动节","2018-05-01":"劳动节","2018-06-18":"端午节","2018-09-24":"中秋节","2018-10-01":"国庆节","2018-10-02":"国庆节","2018-10-03":"国庆节","2018-10-04":"国庆节","2018-10-05":"国庆节","2018-10-06":"国庆节","2018-10-07":"国庆节","2018-12-30":"元旦","2018-12-31":"元旦","2019-01-01":"元旦","2019-02-04":"春节","2019-02-05":"春节","2019-02-06":"春节","2019-02-07":"春节","2019-02-08":"春节","2019-02-09":"春节","2019-02-10":"春节","2019-04-05":"清明节","2019-04-06":"清明节","2019-04-07":"清明节","2019-05-01":"劳动节","2019-05-02":"劳动节","2019-05-03":"劳动节","2019-05-04":"劳动节","2019-06-07":"端午节","2019-06-08":"端午节","2019-06-09":"端午节","2019-09-13":"中秋节","2019-09-14":"中秋节","2019-09-15":"中秋节","2019-10-01":"国庆节","2019-10-02":"国庆节","2019-10-03":"国庆节","2019-10-04":"国庆节","2019-10-05":"国庆节","2019-10-06":"国庆节","2019-10-07":"国庆节","2020-01-01":"元旦","2020-01-24":"春节","2020-01-25":"春节","2020-01-26":"春节","2020-01-27":"春节","2020-01-28":"春节","2020-01-29":"春节","2020-01-30":"春节","2020-04-04":"清明节","2020-04-05":"清明节","2020-04-06":"清明节","2020-05-01":"劳动节","2020-05-02":"劳动节","2020-05-03":"劳动节","2020-05-04":"劳动节","2020-05-05":"劳动节","2020-06-25":"端午节","2020-06-26":"端午节","2020-06-27":"端午节","2020-10-01":"国庆节","2020-10-02":"国庆节","2020-10-03":"国庆节","2020-10-04":"国庆节","2020-10-05":"国庆节","2020-10-06":"国庆节","2020-10-07":"国庆节","2020-10-08":"国庆节","2021-01-01":"元旦","2021-02-11":"春节","2021-02-12":"春节","2021-02-13":"春节","2021-02-14":"春节","2021-02-15":"春节","2021-02-16":"春节","2021-02-17":"春节","2021-04-03":"清明节","2021-04-04":"清明节","2021-04-05":"清明节","2021-05-01":"劳动节","2021-05-02":"劳动节","2021-05-03":"劳动节","2021-05-04":"劳动节","2021-05-05":"劳动节","2021-06-12":"端午节","2021-06-13":"端午节","2021-06-14":"端午节","2021-09-19":"中秋节","2021-09-20":"中秋节","2021-09-21":"中秋节","2021-10-01":"国庆节","2021-10-02":"国庆节","2021-10-03":"国庆节","2021-10-04":"国庆节","2021-10-05":"国庆节","2021-10-06":"国庆节","2021-10-07":"国庆节","2022-01-01":"元旦","2022-01-02":"元旦","2022-01-03":"元旦","2022-01-31":"春节","2022-02-01":"春节","2022-02-02":"春节","2022-02-03":"春节","2022-02-04":"春节","2022-02-05":"春节","2022-02-06":"春节","2022-04-03":"清明节","2022-04-04":"清明节","2022-04-05":"清明节","2022-04-30":"劳动节","2022-05-01":"劳动节","2022-05-02":"劳动节","2022-05-03":"劳动节","2022-05-04":"劳动节","2022-06-03":"端午节","2022-06-04":"端午节","2022-06-05":"端午节","2022-09-10":"中秋节","2022-09-11":"中秋节","2022-09-12":"中秋节","2022-10-01":"国庆节","2022-10-02":"国庆节","2022-10-03":"国庆节","2022-10-04":"国庆节","2022-10-05":"国庆节","2022-10-06":"国庆节","2022-10-07":"国庆节","2022-12-31":"元旦","2023-01-01":"元旦","2023-01-02":"元旦","2023-01-03":"元旦","2023-01-21":"春节","2023-01-22":"春节","2023-01-23":"春节","2023-01-24":"春节","2023-01-25":"春节","2023-01-26":"春节","2023-01-27":"春节","2023-04-05":"清明节","2023-04-29":"劳动节","2023-04-30":"劳动节","2023-05-01":"劳动节","2023-05-02":"劳动节","2023-05-03":"劳动节","2023-06-22":"端午节","2023-06-23":"端午节","2023-06-24":"端午节","2023-09-29":"中秋节","2023-09-30":"中秋节","2023-10-01":"国庆节","2023-10-02":"国庆节","2023-10-03":"国庆节","2023-10-04":"国庆节","2023-10-05":"国庆节","2023-10-06":"国庆节","2024-01-01":"元旦","2024-02-10":"春节","2024-02-11":"春节","2024-02-12":"春节","2024-02-13":"春节","2024-02-14":"春节","2024-02-15":"春节","2024-02-16":"春节","2024-02-17":"春节","2024-04-04":"清明节","2024-04-05":"清明节","2024-04-06":"清明节","2024-05-01":"劳动节","2024-05-02":"劳动节","2024-05-03":"劳动节","2024-05-04":"劳动节","2024-05-05":"劳动节","2024-06-10":"端午节","2024-09-15":"中秋节","2024-09-16":"中秋节","2024-09-17":"中秋节","2024-10-01":"国庆节","2024-10-02":"国庆节","2024-10-03":"国庆节","2024-10-04":"国庆节","2024-10-05":"国庆节","2024-10-06":"国庆节","2024-10-07":"国庆节","2025-01-01":"元旦","2025-01-28":"春节","2025-01-29":"春节","2025-01-30":"春节","2025-01-31":"春节","2025-02-01":"春节","2025-02-02":"春节","2025-02-03":"春节","2025-02-04":"春节","2025-04-04":"清明节","2025-04-05":"清明节","2025-04-06":"清明节","2025-05-01":"劳动节","2025-05-02":"劳动节","2025-05-03":"劳动节","2025-05-04":"劳动节","2025-05-05":"劳动节","2025-05-31":"端午节","2025-06-01":"端午节","2025-06-02":"端午节","2025-10-01":"国庆节","2025-10-02":"国庆节","2025-10-03":"国庆节","2025-10-04":"国庆节","2025-10-05":"国庆节","2025-10-06":"国庆节","2025-10-07":"国庆节","2025-10-08":"国庆节","2026-01-01":"元旦","2026-01-02":"元旦","2026-01-03":"元旦","2026-02-15":"春节","2026-02-16":"春节","2026-02-17":"春节","2026-02-18":"春节","2026-02-19":"春节","2026-02-20":"春节","2026-02-21":"春节","2026-02-22":"春节","2026-02-23":"春节","2026-04-04":"清明节","2026-04-05":"清明节","2026-04-06":"清明节","2026-05-01":"劳动节","2026-05-02":"劳动节","2026-05-03":"劳动节","2026-05-04":"劳动节","2026-05-05":"劳动节","2026-06-19":"端午节","2026-06-20":"端午节","2026-06-21":"端午节","2026-09-25":"中秋节","2026-09-26":"中秋节","2026-09-27":"中秋节","2026-10-01":"国庆节","2026-10-02":"国庆节","2026-10-03":"国庆节","2026-10-04":"国庆节","2026-10-05":"国庆节","2026-10-06":"国庆节","2026-10-07":"国庆节"},a={"2011-01-29":"补春节","2011-01-30":"补春节","2011-10-08":"补国庆节","2011-10-09":"补国庆节","2012-01-21":"补春节","2012-09-29":"补国庆节","2012-09-30":"补国庆节","2013-01-05":"补元旦","2013-01-06":"补元旦","2013-02-16":"补春节","2013-02-17":"补春节","2013-09-22":"补中秋国庆","2013-09-29":"补中秋国庆","2013-12-29":"补元旦","2014-01-26":"补春节","2014-02-08":"补春节","2014-05-04":"补劳动节","2014-09-28":"补国庆节","2015-01-04":"补元旦","2015-02-15":"补春节","2015-02-28":"补春节","2015-09-06":"补抗战胜利","2015-10-10":"补国庆节","2016-02-06":"补春节","2016-02-14":"补春节","2016-06-12":"补端午节","2016-09-18":"补中秋节","2016-10-08":"补国庆节","2016-10-09":"补国庆节","2017-01-22":"补春节","2017-02-04":"补春节","2017-04-01":"补清明节","2017-05-27":"补端午节","2017-09-30":"补国庆节","2018-02-11":"补春节","2018-02-24":"补春节","2018-04-08":"补清明节","2018-04-28":"补劳动节","2018-09-29":"补国庆节","2018-09-30":"补国庆节","2018-12-29":"补元旦","2019-02-02":"补春节","2019-02-03":"补春节","2019-04-28":"补劳动节","2019-05-05":"补劳动节","2019-09-29":"补国庆节","2019-10-12":"补国庆节","2020-01-19":"补春节","2020-02-01":"补春节","2020-04-26":"补劳动节","2020-05-09":"补劳动节","2020-06-28":"补端午节","2020-09-27":"补国庆节","2020-10-10":"补国庆节","2021-02-07":"补春节","2021-02-20":"补春节","2021-04-25":"补劳动节","2021-05-08":"补劳动节","2021-09-18":"补中秋节","2021-09-26":"补国庆节","2021-10-09":"补国庆节","2022-01-29":"补春节","2022-01-30":"补春节","2022-04-02":"补清明节","2022-04-24":"补劳动节","2022-05-07":"补劳动节","2022-10-08":"补国庆节","2022-10-09":"补国庆节","2023-01-28":"补春节","2023-01-29":"补春节","2023-04-23":"补劳动节","2023-05-06":"补劳动节","2023-06-25":"补端午节","2023-10-07":"补国庆节","2023-10-08":"补国庆节","2024-02-04":"补春节","2024-02-18":"补春节","2024-04-07":"补清明节","2024-04-28":"补劳动节","2024-05-11":"补劳动节","2024-09-14":"补中秋节","2024-09-29":"补国庆节","2024-10-12":"补国庆节","2025-01-26":"补春节","2025-02-08":"补春节","2025-04-27":"补劳动节","2025-09-28":"补国庆节","2025-10-11":"补国庆节","2026-01-04":"补元旦","2026-02-14":"补春节","2026-02-28":"补春节","2026-05-09":"补劳动节","2026-09-20":"补国庆节","2026-10-10":"补国庆节"};function r(t){if(void 0===t){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,a=t.getDate();return{date:`${e}-${n<10?"0":""}${n}-${a<10?"0":""}${a}`,weekends:!1}}if(t instanceof Date){const e=t.getFullYear(),n=t.getMonth()+1,a=t.getDate(),r=`${e}-${n<10?"0":""}${n}-${a<10?"0":""}${a}`,s=t.getDay();return{date:r,weekends:0===s||6===s}}if("number"==typeof t){const e=new Date(t),n=e.getFullYear(),a=e.getMonth()+1,r=e.getDate(),s=`${n}-${a<10?"0":""}${a}-${r<10?"0":""}${r}`,o=e.getDay();return{date:s,weekends:0===o||6===o}}if(t.includes("/")){const e=t.split("/");if(3===e.length){const t=parseInt(e[0]),n=parseInt(e[1])-1,a=parseInt(e[2]),r=new Date(t,n,a),s=r.getFullYear(),o=r.getMonth()+1,i=r.getDate(),u=`${s}-${o<10?"0":""}${o}-${i<10?"0":""}${i}`,d=r.getDay();return{date:u,weekends:0===d||6===d}}}const e=new Date(t);if(isNaN(e.getTime()))throw new Error(`Invalid date: ${t}`);const n=e.getFullYear(),a=e.getMonth()+1,r=e.getDate(),s=e.getDay();return{date:`${n}-${a<10?"0":""}${a}-${r<10?"0":""}${r}`,weekends:0===s||6===s}}function s(t){let s;if("string"==typeof t&&10===t.length&&"-"===t[4]&&"-"===t[7]){s=t;const r=e.get(s);if(r&&void 0!==r.isWorkday)return r.isWorkday;if(a[s])return e.set(s,{isWorkday:!0}),!0;if(n[s])return e.set(s,{isWorkday:!1}),!1;const o=new Date(s+"T00:00:00").getDay(),i=!(0===o||6===o);return e.set(s,{isWorkday:i}),i}const o=r(t);s=o.date;const i=e.get(s);if(i&&void 0!==i.isWorkday)return i.isWorkday;let u;return u=!!a[s]||!n[s]&&!o.weekends,e.set(s,{isWorkday:u}),u}function o(t){return!s(t)}function i(t){const e=r(t);return!!a[e.date]}function u(t){if("string"==typeof t&&10===t.length&&"-"===t[4]&&"-"===t[7]){let r=e.get(t);if(r&&r.festival)return r.festival;let s=a[t];if(s)return e.set(t,{festival:s}),s;const o=n[t];if(o)return e.set(t,{festival:o}),o;const i=new Date(t+"T00:00:00").getDay(),u=0===i||6===i?"周末":"工作日";return e.set(t,{festival:u}),u}const s=r(t),o=e.get(s.date);if(o&&o.festival)return o.festival;let i;return i=a[s.date]?a[s.date]:n[s.date]?n[s.date]:s.weekends?"周末":"工作日",e.set(s.date,{festival:i}),i}function d(t,e){const n=new Date(t+"T00:00:00");n.setDate(n.getDate()+e);return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function l(t){let e=r(t).date;for(let t=1;t<=7;t++){const n=d(e,t);if(s(n))return n}return null}function c(t){let e=r(t).date;for(let t=1;t<=14;t++){const n=d(e,-t);if(s(n))return n}return null}function f(t,e){const n=r(t).date,a=r(e).date;if(n>a)return 0;let o=0,i=n;for(;i<=a;)s(i)&&o++,i=d(i,1);return o}const g={2011:"2011-02-03",2012:"2012-01-23",2013:"2013-02-10",2014:"2014-01-31",2015:"2015-02-19",2016:"2016-02-08",2017:"2017-01-28",2018:"2018-02-16",2019:"2019-02-05",2020:"2020-01-25",2021:"2021-02-12",2022:"2022-02-01",2023:"2023-01-22",2024:"2024-02-10",2025:"2025-01-29",2026:"2026-02-17"},y=new Map,h=[29,30],D={1:"正月",2:"二月",3:"三月",4:"四月",5:"五月",6:"六月",7:"七月",8:"八月",9:"九月",10:"十月",11:"冬月",12:"腊月"},p={1:"初一",2:"初二",3:"初三",4:"初四",5:"初五",6:"初六",7:"初七",8:"初八",9:"初九",10:"初十",11:"十一",12:"十二",13:"十三",14:"十四",15:"十五",16:"十六",17:"十七",18:"十八",19:"十九",20:"二十",21:"廿一",22:"廿二",23:"廿三",24:"廿四",25:"廿五",26:"廿六",27:"廿七",28:"廿八",29:"廿九",30:"三十"},m={"1-1":"春节","1-15":"元宵节","5-5":"端午节","8-15":"中秋节","9-9":"重阳节","12-8":"腊八节","12-23":"小年"};function S(t){const e=r(t),n=e.date;if(y.has(n))return y.get(n);const a=parseInt(n.split("-")[0]);let s=null,o=0,i=null;for(let t=a;t>=a-1;t--){if(i=g[t],!i)continue;const e=new Date(i+"T00:00:00"),a=new Date(n+"T00:00:00").getTime()-e.getTime();if(o=Math.floor(a/864e5),o>=0){s=t;break}}if(null===s){const t={date:n,lunarYear:null,lunarMonth:null,lunarDay:null,lunarString:"",lunarFestival:"",dayOfWeek:e.weekends?"周末":"工作日"};return y.set(n,t),t}let u=o,d=1,l=1;for(;u>=h[(d-1)%2];)u-=h[(d-1)%2],d++,d>12&&(d=1,s++);l=u+1;const c={date:n,lunarYear:s,lunarMonth:d,lunarDay:l,lunarString:(D[d]||`${d}月`)+(p[l]||`${l}`),lunarFestival:m[`${d}-${l}`]||"",dayOfWeek:e.weekends?"周末":"工作日"};return y.set(n,c),c}function $(t,e){const n=r(t).date;if(0===e)return s(n)?n:l(n);let a=n,o=Math.abs(e);if(e>0)for(;o>0;){if(a=l(a),!a)return null;o--}else for(;o>0;){if(a=c(a),!a)return null;o--}return a}function w(t){if("number"!=typeof t||t<2011||t>2026)throw new Error("Year must be between 2011 and 2026");const e=String(t),a=`${e}-12-31`;let r=0,o=0,u=0,d=0,l=0,c={},f=`${e}-01-01`;for(;f<=a;){if(r++,s(f))o++,i(f)&&l++;else if(n[f]){u++;const t=n[f];c[t]=(c[t]||0)+1}else d++;const t=new Date(f+"T00:00:00");t.setDate(t.getDate()+1);f=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}return{year:t,totalDays:r,workdays:o,holidays:u,weekends:d,additionalWorkdays:l,workdayPercentage:parseFloat((o/r*100).toFixed(2)),holidayDistribution:c}}function k(t){let e=r(t).date;const a=new Date(e+"T00:00:00");for(let t=0;t<365;t++){a.setDate(a.getDate()+1);if(e=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`,n[e])return{date:e,festival:n[e],daysUntil:t+1}}return null}let v={};function W(t,n="default"){const a=v[n];if(!a)return s(t);const o=r(t).date,i=`custom_${n}_${o}`,u=e.get(i);if(u&&void 0!==u.isWorkday)return u.isWorkday;if(a.workdaysOnWeekends.includes(o))return e.set(i,{isWorkday:!0}),!0;if(a.holidays.includes(o))return e.set(i,{isWorkday:!1}),!1;const d=new Date(o+"T00:00:00").getDay(),l=a.workdays.includes(d);return e.set(i,{isWorkday:l}),l}function b(t,e){const n=r(t).date,a=r(e).date,s=new Date(n+"T00:00:00"),o=new Date(a+"T00:00:00").getTime()-s.getTime();return Math.abs(Math.floor(o/864e5))+1}let T={};function F(t,e,n={}){const{startDay:a=1,includeFestival:r=!0,includeLunar:o=!1}=n,i=new Date(t,e-1,1),d=new Date(t,e,0).getDate(),l=(i.getDay()-a+7)%7,c=[];let f=[];const g=new Date(t,e-1,0).getDate();for(let n=0;n<l;n++){const a=g-l+n+1,i=1===e?12:e-1,d=1===e?t-1:t,c=`${d}-${String(i).padStart(2,"0")}-${String(a).padStart(2,"0")}`,y={year:d,month:i,date:a,dayType:"prevMonth",isWorkday:s(c),dateStr:c};if(r&&(y.festival=u(c)),o){const t=S(c);y.lunar=t.lunarString}f.push(y)}for(let n=1;n<=d;n++){const a=`${t}-${String(e).padStart(2,"0")}-${String(n).padStart(2,"0")}`,i={year:t,month:e,date:n,dayType:"currentMonth",isWorkday:s(a),dateStr:a};if(r&&(i.festival=u(a)),o){const t=S(a);i.lunar=t.lunarString}f.push(i),7===f.length&&(c.push(f),f=[])}const y=7-f.length;for(let n=0;n<y;n++){const a=n+1,i=12===e?1:e+1,d=12===e?t+1:t,l=`${d}-${String(i).padStart(2,"0")}-${String(a).padStart(2,"0")}`,c={year:d,month:i,date:a,dayType:"nextMonth",isWorkday:s(l),dateStr:l};if(r&&(c.festival=u(l)),o){const t=S(l);c.lunar=t.lunarString}f.push(c)}return f.length>0&&c.push(f),c}function M(t,e="Asia/Shanghai"){let n;if("string"==typeof t){if(/^\d{4}-\d{2}-\d{2}$/.test(t)){const[a,r,o]=t.split("-").map(Number);n=new Date(Date.UTC(a,r-1,o));const i=new Date(n.toLocaleString("en-US",{timeZone:e})),u=i.getFullYear(),d=i.getMonth()+1,l=i.getDate();return s(`${u}-${String(d).padStart(2,"0")}-${String(l).padStart(2,"0")}`)}n=new Date(t)}else if(t instanceof Date)n=t;else{if("number"!=typeof t)throw new Error("Invalid date format");n=new Date(t)}const a={timeZone:e,year:"numeric",month:"2-digit",day:"2-digit"},r=new Intl.DateTimeFormat("en-CA",a),[o,i,u]=r.format(n).split("-");return s(`${o}-${i}-${u}`)}t.addLeaveDays=function(t,e,n){const a=T[t];if(!a)return{success:!1,message:"User not found",remainingBalance:null};if(a.hasOwnProperty(e))return a[e]=(a[e]||0)+n,{success:!0,message:`${n} days added to ${e} leave`,remainingBalance:{...a}};if("custom"===e&&"object"==typeof n){for(const[t,e]of Object.entries(n))a.custom[t]=(a.custom[t]||0)+e;return{success:!0,message:"Custom leave days added",remainingBalance:{...a}}}return"number"==typeof n&&e.startsWith("custom_")?(a.custom[e.substring(7)]=(a.custom[e.substring(7)]||0)+n,{success:!0,message:`${n} days added to custom ${e.substring(7)} leave`,remainingBalance:{...a}}):{success:!1,message:`Unknown leave type: ${e}`,remainingBalance:a}},t.addWorkdays=$,t.applyLeave=function(t,e,n,a,r=!0){const s=T[t];if(!s)return{success:!1,message:"User not found",remainingBalance:null};let o;return o=r?f(n,a):b(n,a),"custom"===e?{success:!1,message:"For custom leave, specify the exact custom type",remainingBalance:s}:s.hasOwnProperty(e)?s[e]<o?{success:!1,message:`Insufficient ${e} leave balance`,remainingBalance:s}:(s[e]-=o,{success:!0,message:`${o} days of ${e} leave applied successfully`,leaveDays:o,remainingBalance:{...s}}):{success:!1,message:`Unknown leave type: ${e}`,remainingBalance:s}},t.calculateActualWorkdays=function(t,e,n=[]){const a=f(t,e);let s=0;for(const a of n)if(a.approved){const n=r(a.startDate).date,o=r(a.endDate).date,i=r(t).date,u=r(e).date,d=n>i?n:i,l=o<u?o:u;d<=l&&(s+=f(d,l))}return Math.max(0,a-s)},t.calculateWorkHours=function(t,e,n=8){return f(t,e)*n},t.clearCache=function(){e.cache.clear(),e.hits=0,e.misses=0},t.clearWorkSchedule=function(t){delete v[t]},t.convertTimezoneAndCheckWorkday=function(t,e,n,a=!0){let o;if("string"==typeof t)if(/^\d{4}-\d{2}-\d{2}$/.test(t)){const[e,n,a]=t.split("-").map(Number);o=new Date(e,n-1,a,12,0,0)}else o=new Date(t);else if(t instanceof Date)o=t;else{if("number"!=typeof t)throw new Error("Invalid date format");o=new Date(t)}const i={timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},u=new Intl.DateTimeFormat("en-CA",i).formatToParts(o);let d,l,c,f,g,y;for(const t of u)switch(t.type){case"year":d=t.value;break;case"month":l=t.value;break;case"day":c=t.value;break;case"hour":f=t.value;break;case"minute":g=t.value;break;case"second":y=t.value}const h=new Date(`${d}-${l}-${c}T${f}:${g}:${y}`),D=new Date(h.toLocaleString("en-US",{timeZone:n})),p=D.getFullYear(),m=D.getMonth()+1,S=D.getDate(),$=`${p}-${String(m).padStart(2,"0")}-${String(S).padStart(2,"0")}`;return{originalDate:r(t).date,convertedDate:$,isWorkdayInChina:a?s($):void 0,fromTimezone:e,toTimezone:n}},t.countWorkdays=f,t.daysUntilHoliday=function(t){const e=k(t);return e?e.daysUntil:-1},t.generateCalendar=F,t.generateCompactCalendar=function(t,e){const a=F(t,e);let r=0,s=0,o=0;for(const t of a)for(const e of t)"currentMonth"===e.dayType&&(e.isWorkday?r++:n[e.dateStr]?s++:o++);return{year:t,month:e,calendar:a,stats:{workdays:r,holidays:s,weekends:o,total:r+s+o}}},t.getAnnualStats=w,t.getAvailableSchedules=function(){return Object.keys(v)},t.getCacheStats=function(){return e.getStats()},t.getConsecutiveHolidays=function(t){const e=r(t).date;if(!n[e])return 0;let a=1,o=e;const u=new Date(o+"T00:00:00");for(;;){u.setDate(u.getDate()+1);if(o=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")}`,!n[o]&&(s(o)||i(o)))break;a++}return a},t.getDaysInMonth=function(t,e,a="workdays"){const r=[],o=new Date(t,e,0).getDate();for(let i=1;i<=o;i++){const o=`${t}-${String(e).padStart(2,"0")}-${String(i).padStart(2,"0")}`;let u=!1;u="workdays"===a?s(o):"holidays"===a?!s(o)&&n[o]:"weekends"!==a||!s(o)&&!n[o],u&&r.push(o)}return r},t.getFestival=u,t.getFestivalBatch=function(t){return t.map(t=>"string"==typeof t&&10===t.length&&"-"===t[4]&&"-"===t[7]?t:r(t).date).map(t=>{const r=e.get(t);if(r&&r.festival)return r.festival;let s;if(a[t])s=a[t];else if(n[t])s=n[t];else{const e=new Date(t+"T00:00:00").getDay();s=0===e||6===e?"周末":"工作日"}return e.set(t,{festival:s}),s})},t.getHolidaysByFestival=function(t,e){const a=r(t).date,s=r(e).date;if(a>s)throw new Error("Start date must be before end date");const o={};let i=a;for(;i<=s;){const t=n[i];t&&(o[t]||(o[t]=[]),o[t].push(i));const e=new Date(i+"T00:00:00");e.setDate(e.getDate()+1);i=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}return o},t.getHolidaysInRange=function(t,e){const n=r(t).date,a=r(e).date;if(n>a)return[];const s=[];let o=n;for(;o<=a;){const t=u(o);"工作日"!==t&&"周末"!==t&&s.push({date:o,festival:t}),o=d(o,1)}return s},t.getLeaveBalance=function(t){return T[t]||null},t.getLunarInfo=S,t.getMonthRange=function(t){const e=r(t).date.split("-"),n=parseInt(e[0]),a=parseInt(e[1])-1,s=new Date(n,a,1),o=new Date(n,a+1,0);return{startDate:`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`,endDate:`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`}},t.getMonthlyStats=function(t,e){if("number"!=typeof t||t<2011||t>2026)throw new Error("Year must be between 2011 and 2026");if("number"!=typeof e||e<1||e>12)throw new Error("Month must be between 1 and 12");const a=String(t)+"-"+String(e).padStart(2,"0"),r=a+"-01",o=new Date(t,e,0).getDate(),u=a+"-"+String(o).padStart(2,"0");let d=0,l=0,c=0,f=0,g=0,y=r;for(;y<=u;){d++,s(y)?(l++,i(y)&&g++):n[y]?c++:f++;const t=new Date(y+"T00:00:00");t.setDate(t.getDate()+1);y=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}return{year:t,month:e,totalDays:d,workdays:l,holidays:c,weekends:f,additionalWorkdays:g,workdayPercentage:parseFloat((l/d*100).toFixed(2))}},t.getMostCommonHoliday=function(t){const e=w(t);if(!e||!e.holidayDistribution)return null;let n=null,a=0;for(const[t,r]of Object.entries(e.holidayDistribution))r>a&&(a=r,n={festival:t,count:r});return n},t.getNextHoliday=k,t.getTotalDays=b,t.getWeekRange=function(t,e=1){const n=r(t),a=new Date(n.date+"T00:00:00"),s=(a.getDay()-e+7)%7,o=new Date(a);o.setDate(a.getDate()-s);const i=new Date(o);return i.setDate(o.getDate()+6),{startDate:`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`,endDate:`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`}},t.getWorkSchedule=function(t){return v[t]||null},t.getWorkdayInMultipleTimezones=function(t,e){const n={};for(const a of e)n[a]=M(t,a);return n},t.getWorkdayRatio=function(t,e){const a=r(t).date,o=r(e).date;if(a>o)throw new Error("Start date must be before end date");let u=0,d=0,l=0,c=0,f=0,g=a;for(;g<=o;){u++,s(g)?(d++,i(g)&&f++):n[g]?l++:c++;const t=new Date(g+"T00:00:00");t.setDate(t.getDate()+1);g=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}return{startDate:a,endDate:o,totalDays:u,workdays:d,holidays:l,weekends:c,additionalWorkdays:f,workdayCount:d,workdayPercentage:parseFloat((d/u*100).toFixed(2)),holidayPercentage:parseFloat((l/u*100).toFixed(2)),weekendPercentage:parseFloat((c/u*100).toFixed(2))}},t.getWorkdaySequence=function(t,e,n=1){const a=r(t).date,o=r(e).date;if(a>o)return[];const i=[];let u=s(a)?a:l(a);for(;u&&u<=o&&(i.push(u),u=$(u,n),u&&!(u>o)););return i},t.getWorkdaysInRange=function(t,e){const n=r(t).date,a=r(e).date;if(n>a)return[];const o=[];let i=n;for(;i<=a;)s(i)&&o.push(i),i=d(i,1);return o},t.getWorkdaysInterval=function(t,e){const n=r(t).date,a=r(e).date;if(n===a)return 0;if(new Date(n+"T00:00:00")>new Date(a+"T00:00:00")){let t=0,e=c(n);for(;e&&e>=a;)t++,e=c(e);return t}{let t=0,e=l(n);for(;e&&e<=a;)t++,e=l(e);return t}},t.isAddtionalWorkday=i,t.isHoliday=o,t.isHolidayApproaching=function(t,e=1){const a=r(t).date,s=new Date(a+"T00:00:00");for(let t=1;t<=e;t++){s.setDate(s.getDate()+1);const t=s.getFullYear(),e=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");if(n[`${t}-${e}-${a}`])return!0}return!1},t.isHolidayBatch=function(t){return t.map(t=>o(t))},t.isHolidayCustom=function(t,e="default"){return!W(t,e)},t.isWeekend=function(t){return r(t).weekends},t.isWithinOfficeHours=function(t,e={}){t instanceof Date||(t=new Date(t));const{startHour:n=9,endHour:a=18,startDay:o=1,endDay:i=5}=e,u=t.getDay(),d=t.getHours();return!(u<o||u>i)&&(!!s(r(t).date)&&!(d<n||d>=a))},t.isWorkday=s,t.isWorkdayBatch=function(t){return t.map(t=>"string"==typeof t&&10===t.length&&"-"===t[4]&&"-"===t[7]?t:r(t).date).map(t=>{const r=e.get(t);if(r&&void 0!==r.isWorkday)return r.isWorkday;let s;if(a[t])s=!0;else if(n[t])s=!1;else{const e=new Date(t+"T00:00:00").getDay();s=!(0===e||6===e)}return e.set(t,{isWorkday:s}),s})},t.isWorkdayCustom=W,t.isWorkdayInTimezone=M,t.nextWorkday=l,t.previousWorkday=c,t.setLeaveBalance=function(t,e){T[t]={annual:0,sick:0,personal:0,marriage:0,maternity:0,paternity:0,custom:{},...e}},t.setWorkSchedule=function(t,e){v[t]={workdays:[1,2,3,4,5],holidays:[],workdaysOnWeekends:[],...e}}});
